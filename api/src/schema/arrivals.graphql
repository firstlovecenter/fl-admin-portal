type SwellDate implements TimeGraphNode {
  id: ID!
    @cypher(
      statement: """
      MATCH (this)
      RETURN toString(this.date) AS id
      """
      columnName: "id"
    )
  date: Date
  swell: Boolean
    @cypher(
      statement: """
      MATCH (this)
      UNWIND labels(this) AS swellStatus
      WITH swellStatus WHERE swellStatus ='SwellDate'
      RETURN true AS swell
      """
      columnName: "swell"
    )
  bussingDate: [BussingRecord!]! @relationship(type: "BUSSED_ON", direction: IN)
}

extend type Member {
  isArrivalsAdminForCouncil: [Council!]!
    @relationship(type: "DOES_ARRIVALS_FOR", direction: OUT)
  isArrivalsAdminForGovernorship: [Governorship!]!
    @relationship(type: "DOES_ARRIVALS_FOR", direction: OUT)
  isArrivalsAdminForStream: [Stream!]!
    @relationship(type: "DOES_ARRIVALS_FOR", direction: OUT)
  isArrivalsAdminForCampus: [Campus!]!
    @relationship(type: "DOES_ARRIVALS_FOR", direction: OUT)
  isArrivalsCounterForStream: [Stream!]!
    @relationship(type: "COUNTS_ARRIVALS_FOR", direction: OUT)
}

extend type Oversight {
  graduatedBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS*5]->(bacentas:Green:Bacenta) RETURN bacentas"
      columnName: "graduatedBacentas"
    )
  icBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS*5]->(bacentas:Red:Bacenta) RETURN bacentas"
      columnName: "icBacentas"
    )
  icBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*5]->(bacentas:Red:Bacenta) RETURN COUNT(DISTINCT bacentas) AS icBacentaCount"
      columnName: "icBacentaCount"
    )
  activeIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*5]->(bacentas:Red:Bacenta:Active) RETURN COUNT(DISTINCT bacentas) AS activeIcBacentaCount"
      columnName: "activeIcBacentaCount"
    )
  vacationIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*5]-(bacentas:Red:Bacenta:Vacation) RETURN COUNT(DISTINCT bacentas) AS vacationIcBacentaCount"
      columnName: "vacationIcBacentaCount"
    )
}

extend type Campus {
  arrivalsAdmin: Member @relationship(type: "DOES_ARRIVALS_FOR", direction: IN)
  bacentasNoActivity(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      WHERE NOT EXISTS {
        MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        }
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasNoActivity"
    )
  bacentasNoActivityCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
       WHERE NOT EXISTS {
         MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
         }
      RETURN COUNT(DISTINCT bacentas) AS bacentasNoActivityCount
      """
      columnName: "bacentasNoActivityCount"
    )
  bacentasMobilising(arrivalDate: String): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.mobilisationPicture IS NOT NULL
        AND bussing.leaderDeclaration IS NULL
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasMobilising"
    )
  bacentasMobilisingCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.mobilisationPicture IS NOT NULL
        AND bussing.leaderDeclaration IS NULL
      RETURN COUNT(DISTINCT bacentas) AS bacentasMobilisingCount
      """
      columnName: "bacentasMobilisingCount"
    )
  bacentasOnTheWay(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        }
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasOnTheWay"
    )
  bacentasOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        }
      RETURN COUNT(DISTINCT bacentas) AS bacentasOnTheWayCount
      """
      columnName: "bacentasOnTheWayCount"
    )
  bussingMembersOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
      WITH DISTINCT record
      RETURN SUM(record.leaderDeclaration) AS bussingMembersOnTheWayCount
      """
      columnName: "bussingMembersOnTheWayCount"
    )
  bacentasNotCounted(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date)=date($arrivalDate)
      MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE NOT EXISTS {
       MATCH (record)-[:COUNTED_BY]->(:Member)
      }
      RETURN DISTINCT bacentas AS bacentasNotCounted
      """
      columnName: "bacentasNotCounted"
    )
  vehiclesNotCountedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date)=date($arrivalDate)
      MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE NOT EXISTS {
       MATCH (record)-[:COUNTED_BY]->(:Member)
      }
      RETURN COUNT(DISTINCT record) AS vehiclesNotCountedCount
      """
      columnName: "vehiclesNotCountedCount"
    )
  bacentasBelow8(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.attendance < 8
        WITH bacentas, bussing ORDER BY bussing.attendance ASC
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasBelow8"
    )
  bacentasBelow8Count(arrivalDate: String!): Int!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.attendance < 8
        WITH bacentas, bussing ORDER BY bussing.attendance ASC
      RETURN COUNT(DISTINCT bacentas) AS bacentasBelow8Count
      """
      columnName: "bacentasBelow8Count"
    )
  bacentasHaveArrived(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
       WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL AND record.attendance > 0
        }
        WITH bacentas, bussing ORDER BY bussing.attendance DESC
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasHaveArrived"
    )
  bacentasHaveArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL AND record.attendance > 0
        }
      RETURN COUNT(DISTINCT bacentas) AS bacentasHaveArrivedCount
      """
      columnName: "bacentasHaveArrivedCount"
    )
  bussingMembersHaveArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL
        WITH DISTINCT record
      RETURN SUM(record.attendance) AS bussingMembersHaveArrivedCount
      """
      columnName: "bussingMembersHaveArrivedCount"
    )
  bussesOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        AND record.leaderDeclaration IS NOT NULL
        AND record.vehicle <> 'Car'
      RETURN COUNT(DISTINCT record) AS bussesOnTheWayCount
      """
      columnName: "bussesOnTheWayCount"
    )
  bussesThatArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*4]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL
        AND record.attendance > 0
        AND record.vehicle <> 'Car'
      RETURN COUNT(DISTINCT record) AS bussesThatArrivedCount
      """
      columnName: "bussesThatArrivedCount"
    )
  graduatedBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS*4]->(bacentas:Green:Bacenta) RETURN bacentas"
      columnName: "graduatedBacentas"
    )
  icBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS*4]->(bacentas:Red:Bacenta) RETURN bacentas"
      columnName: "icBacentas"
    )
  icBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*4]->(bacentas:Red:Bacenta) RETURN COUNT(DISTINCT bacentas) AS icBacentaCount"
      columnName: "icBacentaCount"
    )
  activeIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*4]->(bacentas:Red:Bacenta:Active) RETURN COUNT(DISTINCT bacentas) AS activeIcBacentaCount"
      columnName: "activeIcBacentaCount"
    )
  vacationIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*4]-(bacentas:Red:Bacenta:Vacation) RETURN COUNT(DISTINCT bacentas) AS vacationIcBacentaCount"
      columnName: "vacationIcBacentaCount"
    )
}

extend type Stream {
  arrivalsAdmin: Member @relationship(type: "DOES_ARRIVALS_FOR", direction: IN)
  arrivalsCounters: [Member!]!
    @relationship(type: "COUNTS_ARRIVALS_FOR", direction: IN)
  bacentasNoActivity(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      WHERE NOT EXISTS {
        MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        }
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasNoActivity"
    )
  bacentasNoActivityCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
       WHERE NOT EXISTS {
         MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
         }
      RETURN COUNT(DISTINCT bacentas) AS bacentasNoActivityCount
      """
      columnName: "bacentasNoActivityCount"
    )
  bacentasMobilising(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.mobilisationPicture IS NOT NULL
        AND bussing.leaderDeclaration IS NULL
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasMobilising"
    )
  bacentasMobilisingCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.mobilisationPicture IS NOT NULL
        AND bussing.leaderDeclaration IS NULL
      RETURN COUNT(DISTINCT bacentas) AS bacentasMobilisingCount
      """
      columnName: "bacentasMobilisingCount"
    )
  bacentasOnTheWay(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        }
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasOnTheWay"
    )
  bacentasOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        }
      RETURN COUNT(DISTINCT bacentas) AS bacentasOnTheWayCount
      """
      columnName: "bacentasOnTheWayCount"
    )
  bussesOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        AND record.leaderDeclaration IS NOT NULL
        AND record.vehicle <> 'Car'
      RETURN COUNT(DISTINCT record) AS bussesOnTheWayCount
      """
      columnName: "bussesOnTheWayCount"
    )
  bussingMembersOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
      WITH DISTINCT record
      RETURN SUM(record.leaderDeclaration) AS bussingMembersOnTheWayCount
      """
      columnName: "bussingMembersOnTheWayCount"
    )
  bacentasNotCounted(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date)=date($arrivalDate)
      MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE NOT EXISTS {
       MATCH (record)-[:COUNTED_BY]->(:Member)
      }
      RETURN DISTINCT bacentas AS bacentasNotCounted
      """
      columnName: "bacentasNotCounted"
    )
  vehiclesNotCountedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date)=date($arrivalDate)
      MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE NOT EXISTS {
       MATCH (record)-[:COUNTED_BY]->(:Member)
      }
      RETURN COUNT(DISTINCT record) AS vehiclesNotCountedCount
      """
      columnName: "vehiclesNotCountedCount"
    )
  bacentasBelow8(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.attendance < 8
        WITH bacentas, bussing ORDER BY bussing.attendance ASC
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasBelow8"
    )
  bacentasBelow8Count(arrivalDate: String!): Int!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.attendance < 8
        WITH bacentas, bussing ORDER BY bussing.attendance ASC
      RETURN COUNT(DISTINCT bacentas) AS bacentasBelow8Count
      """
      columnName: "bacentasBelow8Count"
    )
  bacentasHaveArrived(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL AND record.attendance > 0
        }
        WITH bacentas, bussing ORDER BY bussing.attendance DESC
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasHaveArrived"
    )
  bacentasHaveArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL AND record.attendance > 0
        }
      RETURN COUNT(DISTINCT bacentas) AS bacentasHaveArrivedCount
      """
      columnName: "bacentasHaveArrivedCount"
    )
  bussingMembersHaveArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL
        WITH DISTINCT record
      RETURN SUM(record.attendance) AS bussingMembersHaveArrivedCount
      """
      columnName: "bussingMembersHaveArrivedCount"
    )
  bussesThatArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*3]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL
        AND record.attendance > 0
        AND record.vehicle <> 'Car'
      RETURN COUNT(DISTINCT record) AS bussesThatArrivedCount
      """
      columnName: "bussesThatArrivedCount"
    )
  graduatedBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS*3]->(bacentas:Green:Bacenta) RETURN bacentas"
      columnName: "graduatedBacentas"
    )
  icBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS*3]->(bacentas:Red:Bacenta) RETURN bacentas"
      columnName: "icBacentas"
    )
  icBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*3]->(bacentas:Red:Bacenta) RETURN COUNT(DISTINCT bacentas) AS icBacentaCount"
      columnName: "icBacentaCount"
    )
  activeIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*3]->(bacentas:Red:Bacenta:Active) RETURN COUNT(DISTINCT bacentas) AS activeIcBacentaCount"
      columnName: "activeIcBacentaCount"
    )
  vacationIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*3]-(bacentas:Red:Bacenta:Vacation) RETURN COUNT(DISTINCT bacentas) AS vacationIcBacentaCount"
      columnName: "vacationIcBacentaCount"
    )
}

extend type Council {
  arrivalsAdmin: Member @relationship(type: "DOES_ARRIVALS_FOR", direction: IN)
  bacentasNoActivity(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      WHERE NOT EXISTS {
        MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        }
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasNoActivity"
    )
  bacentasNoActivityCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
       WHERE NOT EXISTS {
         MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
         }
      RETURN COUNT(DISTINCT bacentas) AS bacentasNoActivityCount
      """
      columnName: "bacentasNoActivityCount"
    )
  bacentasMobilising(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.mobilisationPicture IS NOT NULL
        AND bussing.leaderDeclaration IS NULL
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasMobilising"
    )
  bacentasMobilisingCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.mobilisationPicture IS NOT NULL
        AND bussing.leaderDeclaration IS NULL
      RETURN COUNT(DISTINCT bacentas) AS bacentasMobilisingCount
      """
      columnName: "bacentasMobilisingCount"
    )
  bacentasOnTheWay(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        }
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasOnTheWay"
    )
  bacentasOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        }
      RETURN COUNT(DISTINCT bacentas) AS bacentasOnTheWayCount
      """
      columnName: "bacentasOnTheWayCount"
    )
  bussesOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        AND record.leaderDeclaration IS NOT NULL
        AND record.vehicle <> 'Car'
      RETURN COUNT(DISTINCT record) AS bussesOnTheWayCount
      """
      columnName: "bussesOnTheWayCount"
    )
  bussingMembersOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
      WITH DISTINCT record
      RETURN SUM(record.leaderDeclaration) AS bussingMembersOnTheWayCount
      """
      columnName: "bussingMembersOnTheWayCount"
    )
  bacentasNotCounted(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date)=date($arrivalDate)
      MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE NOT EXISTS {
       MATCH (record)-[:COUNTED_BY]->(:Member)
      }
      RETURN DISTINCT bacenta AS bacentasNotCounted
      """
      columnName: "bacentasNotCounted"
    )
  vehiclesNotCountedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date)=date($arrivalDate)
      MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE NOT EXISTS {
       MATCH (record)-[:COUNTED_BY]->(:Member)
      }
      RETURN COUNT(DISTINCT record) AS vehiclesNotCountedCount
      """
      columnName: "vehiclesNotCountedCount"
    )
  bacentasBelow8(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.attendance < 8
        WITH bacentas, bussing ORDER BY bussing.attendance ASC
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasBelow8"
    )
  bacentasBelow8Count(arrivalDate: String!): Int!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.attendance < 8
        WITH bacentas, bussing ORDER BY bussing.attendance ASC
      RETURN COUNT(DISTINCT bacentas) AS bacentasBelow8Count
      """
      columnName: "bacentasBelow8Count"
    )
  bacentasHaveArrived(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL AND record.attendance > 0
        }
        WITH bacentas, bussing ORDER BY bussing.attendance DESC
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasHaveArrived"
    )
  bacentasHaveArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL AND record.attendance > 0
        }
      RETURN COUNT(DISTINCT bacentas) AS bacentasHaveArrivedCount
      """
      columnName: "bacentasHaveArrivedCount"
    )
  bussingMembersHaveArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL
      WITH DISTINCT record
      RETURN SUM(record.attendance) AS bussingMembersHaveArrivedCount
      """
      columnName: "bussingMembersHaveArrivedCount"
    )
  bussesThatArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS*2]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL
        AND record.attendance > 0
        AND record.vehicle <> 'Car'
      RETURN COUNT(DISTINCT record) AS bussesThatArrivedCount
      """
      columnName: "bussesThatArrivedCount"
    )
  graduatedBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS*2]->(bacentas:Green:Bacenta) RETURN bacentas"
      columnName: "graduatedBacentas"
    )
  icBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS*2]->(bacentas:Red:Bacenta) RETURN bacentas"
      columnName: "icBacentas"
    )
  icBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*2]->(bacentas:Red:Bacenta) RETURN COUNT(DISTINCT bacentas) AS icBacentaCount"
      columnName: "icBacentaCount"
    )
  activeIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*2]->(bacentas:Red:Bacenta:Active) RETURN COUNT(DISTINCT bacentas) AS activeIcBacentaCount"
      columnName: "activeIcBacentaCount"
    )
  vacationIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS*2]-(bacentas:Red:Bacenta:Vacation) RETURN COUNT(DISTINCT bacentas) AS vacationIcBacentaCount"
      columnName: "vacationIcBacentaCount"
    )
}

extend type Governorship {
  #Arrivals in the Governorship
  arrivalsAdmin: Member @relationship(type: "DOES_ARRIVALS_FOR", direction: IN)
  bacentasNoActivity(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      WHERE NOT EXISTS {
        MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        }
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasNoActivity"
    )
  bacentasNoActivityCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
       WHERE NOT EXISTS {
         MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
         }
      RETURN COUNT(DISTINCT bacentas) AS bacentasNoActivityCount
      """
      columnName: "bacentasNoActivityCount"
    )
  bacentasMobilising(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.mobilisationPicture IS NOT NULL
        AND bussing.leaderDeclaration IS NULL
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasMobilising"
    )
  bacentasMobilisingCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.mobilisationPicture IS NOT NULL
        AND bussing.leaderDeclaration IS NULL
      RETURN COUNT(DISTINCT bacentas) AS bacentasMobilisingCount
      """
      columnName: "bacentasMobilisingCount"
    )
  bacentasOnTheWay(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        }
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasOnTheWay"
    )
  bacentasOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        }
      RETURN COUNT(DISTINCT bacentas) AS bacentasOnTheWayCount
      """
      columnName: "bacentasOnTheWayCount"
    )
  bussesOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
        AND record.leaderDeclaration IS NOT NULL
        AND record.vehicle <> 'Car'
      RETURN COUNT(DISTINCT record) AS bussesOnTheWayCount
      """
      columnName: "bussesOnTheWayCount"
    )
  bussingMembersOnTheWayCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NULL
      WITH DISTINCT record
      RETURN SUM(record.leaderDeclaration) AS bussingMembersOnTheWayCount
      """
      columnName: "bussingMembersOnTheWayCount"
    )
  bacentasNotCounted(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
       MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date)=date($arrivalDate)
      MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE NOT EXISTS {
       MATCH (record)-[:COUNTED_BY]->(:Member)
      }
      RETURN DISTINCT bacentas AS bacentasNotCounted
      """
      columnName: "bacentasNotCounted"
    )
  vehiclesNotCountedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date)=date($arrivalDate)
      MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE NOT EXISTS {
       MATCH (record)-[:COUNTED_BY]->(:Member)
      }
      RETURN COUNT(DISTINCT record) AS vehiclesNotCountedCount
      """
      columnName: "vehiclesNotCountedCount"
    )
  bacentasBelow8(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.attendance < 8
        WITH bacentas, bussing ORDER BY bussing.attendance ASC
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasBelow8"
    )
  bacentasBelow8Count(arrivalDate: String!): Int!
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND bussing.attendance < 8
        WITH bacentas, bussing ORDER BY bussing.attendance ASC
      RETURN COUNT(DISTINCT bacentas) AS bacentasBelow8Count
      """
      columnName: "bacentasBelow8Count"
    )
  bacentasHaveArrived(arrivalDate: String!): [Bacenta!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL AND record.attendance > 0
        }
        WITH bacentas, bussing ORDER BY bussing.attendance DESC
      RETURN DISTINCT bacentas
      """
      columnName: "bacentasHaveArrived"
    )
  bacentasHaveArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
        WHERE date(date.date)=date($arrivalDate)
        AND EXISTS {
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL AND record.attendance > 0
        }
      RETURN COUNT(DISTINCT bacentas) AS bacentasHaveArrivedCount
      """
      columnName: "bacentasHaveArrivedCount"
    )
  bussingMembersHaveArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
       MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
       MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL
        WITH DISTINCT record
      RETURN SUM(record.attendance) AS bussingMembersHaveArrivedCount
      """
      columnName: "bussingMembersHaveArrivedCount"
    )
  bussesThatArrivedCount(arrivalDate: String!): Int
    @cypher(
      statement: """
      MATCH (this)-[:HAS]->(bacentas:Active:Bacenta)
      MATCH (bacentas)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
         WHERE date(date.date)=date($arrivalDate)
        MATCH (bussing)-[:INCLUDES_RECORD]->(record:VehicleRecord)
        WHERE record.arrivalTime IS NOT NULL
        AND record.attendance > 0
        AND record.vehicle <> 'Car'
      RETURN COUNT(DISTINCT record) AS bussesThatArrivedCount
      """
      columnName: "bussesThatArrivedCount"
    )
  graduatedBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS]->(bacentas:Green:Bacenta) RETURN bacentas"
      columnName: "graduatedBacentas"
    )
  icBacentas: [Bacenta!]!
    @cypher(
      statement: "MATCH (this)-[:HAS]->(bacentas:Red:Bacenta) RETURN bacentas"
      columnName: "icBacentas"
    )
  icBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS]->(bacentas:Red:Bacenta) RETURN COUNT(DISTINCT bacentas) AS icBacentaCount"
      columnName: "icBacentaCount"
    )
  activeIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS]->(bacentas:Red:Bacenta:Active) RETURN COUNT(DISTINCT bacentas) AS activeIcBacentaCount"
      columnName: "activeIcBacentaCount"
    )
  vacationIcBacentaCount: Int
    @cypher(
      statement: "MATCH (this)-[:HAS]-(bacentas:Red:Bacenta:Vacation) RETURN COUNT(DISTINCT bacentas) AS vacationIcBacentaCount"
      columnName: "vacationIcBacentaCount"
    )
}

extend type Bacenta {
  sprinterTopUp: Float!
  urvanTopUp: Float!
  outbound: Boolean!

  graduationStatus: String!
    @cypher(
      statement: """
      MATCH (this)
      UNWIND labels(this) AS status
      WITH status WHERE status = 'Green' OR status = 'Red'
      RETURN status
      """
      columnName: "graduationStatus"
    )

  mobileNetwork: String
  momoNumber: String
  momoName: String

  #Arrivals Data
  arrivalsCodeOfTheDay: String!
    @cypher(
      statement: "MATCH (arrivals:ArrivalsCodeOfTheDay) RETURN arrivals.code AS arrivalsCodeOfTheDay"
      columnName: "arrivalsCodeOfTheDay"
    )
  bussing(limit: Int!): [BussingRecord!]!
    @cypher(
      statement: """
      MATCH (this)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      RETURN bussing ORDER BY date.date DESC LIMIT $limit
      """
      columnName: "bussing"
    )
  bussingThisWeek(limit: Int! = 1, bussingDate: String!): BussingRecord
    @cypher(
      statement: """
      MATCH (this)-[:HAS_HISTORY]->(:ServiceLog)-[:HAS_BUSSING]->(bussing:BussingRecord)-[:BUSSED_ON]->(date:TimeGraph)
      WHERE date(date.date).week = date($bussingDate).week AND date(date.date).year = date($bussingDate).year
      RETURN bussing AS bussingThisWeek ORDER BY date.date DESC LIMIT $limit
      """
      columnName: "bussingThisWeek"
    )
  code: Int!
}

type BussingRecord implements Record {
  id: ID!

  week: Int!
    @cypher(
      statement: """
      MATCH (this)-[:BUSSED_ON]->(date:TimeGraph)
      RETURN date(date.date).week AS week
      """
      columnName: "week"
    )
  # Mobilisation
  createdAt: DateTime! #mobilisation time is the time the record was created
  serviceDate: TimeGraph! @relationship(type: "BUSSED_ON", direction: OUT)
  mobilisationPicture: String!
  created_by: Member! @relationship(type: "LOGGED_BY", direction: OUT)

  #On The Way
  attendance: Int
  leaderDeclaration: Int
  bussingPictures: [String!]!
    @cypher(
      statement: """
      MATCH (this)-[:INCLUDES_RECORD]->(record:VehicleRecord)
      WHERE record.picture IS NOT NULL
      RETURN collect(record.picture)
      """
      columnName: "bussingPictures"
    )
  numberOfBusses: Int #Legacy Property for before we started collecting Spinter/Urvan details
  numberOfSprinters: Int
  numberOfUrvans: Int
  numberOfCars: Int
  bussingCost: Float
  bussingTopUp: Float

  #Money Things
  mobileNetwork: String
  momoNumber: String
  momoName: String

  counted_by: [Member!]!
    @cypher(
      statement: """
      MATCH (this)-[:INCLUDES_RECORD]->(record:VehicleRecord)-[:COUNTED_BY]->(member:Member)
      RETURN DISTINCT member
      """
      columnName: "counted_by"
    )

  vehicleRecords: [VehicleRecord!]!
    @relationship(type: "INCLUDES_RECORD", direction: OUT)
  serviceLog: ServiceLog! @relationship(type: "HAS_BUSSING", direction: IN)
}

type VehicleRecord {
  id: ID!
  created_by: Member! @relationship(type: "LOGGED_BY", direction: OUT)
  createdAt: DateTime! #mobilisation time is the time the record was created
  leaderDeclaration: Int!
  attendance: Int
  picture: String!
  vehicle: String!

  momoNumber: String
  momoName: String
  mobileNetwork: String
  vehicleTopUp: Float
  vehicleCost: Float!

  counted_by: Member @relationship(type: "COUNTED_BY", direction: OUT)

  #Arrived
  comments: String
  arrivalTime: DateTime
  paystackTransferCode: String
  transactionStatus: String
  transactionReference: String
  outbound: Boolean!

  bussingRecord: BussingRecord!
    @relationship(type: "INCLUDES_RECORD", direction: IN)
}

extend type Mutation {
  #Arrivals Roles
  MakeGovernorshipArrivalsAdmin(
    arrivalsAdminId: ID!
    oldArrivalsAdminId: ID
    governorshipId: ID!
  ): Member!
  RemoveGovernorshipArrivalsAdmin(
    arrivalsAdminId: ID!
    newArrivalsAdminId: ID!
    governorshipId: ID!
  ): Member
  MakeCouncilArrivalsAdmin(
    arrivalsAdminId: ID!
    oldArrivalsAdminId: ID
    councilId: ID!
  ): Member!
  RemoveCouncilArrivalsAdmin(
    arrivalsAdminId: ID!
    newArrivalsAdminId: ID!
    councilId: ID!
  ): Member
  MakeStreamArrivalsAdmin(
    arrivalsAdminId: ID!
    oldArrivalsAdminId: ID
    streamId: ID!
  ): Member!
  RemoveStreamArrivalsAdmin(
    arrivalsAdminId: ID!
    newArrivalsAdminId: ID!
    streamId: ID!
  ): Member
  MakeCampusArrivalsAdmin(
    arrivalsAdminId: ID!
    oldArrivalsAdminId: ID!
    campusId: ID!
  ): Member!
  RemoveCampusArrivalsAdmin(
    arrivalsAdminId: ID!
    newArrivalsAdminId: ID
    campusId: ID!
  ): Member

  MakeStreamArrivalsCounter(arrivalsCounterId: ID!, streamId: ID!): Member!
  RemoveStreamArrivalsCounter(arrivalsCounterId: ID!, streamId: ID!): Member

  ## GENERATE CODE OF THE DAY
  GenerateCodeOfTheDay: String!
    @authentication(
      jwt: {
        OR: [
          { roles_INCLUDES: "adminStream" }
          { roles_INCLUDES: "adminCampus" }
          { roles_INCLUDES: "arrivalsAdminCampus" }
        ]
      }
    )
    @cypher(
      statement: """
      MATCH (arr:ArrivalsCodeOfTheDay)
      SET arr.code = apoc.text.random(5, 'A-Z0-9')
      RETURN arr.code
      """
      columnName: "code"
    )
  SetCodeOfTheDay(code: String!): String!
    @authentication(
      jwt: {
        OR: [
          { roles_INCLUDES: "adminCampus" }
          { roles_INCLUDES: "arrivalsAdminCampus" }
        ]
      }
    )
    @cypher(
      statement: """
      MATCH (arr:ArrivalsCodeOfTheDay)
      SET arr.code = $code
      RETURN arr.code
      """
      columnName: "code"
    )

  UpdateBacentaBussingDetails(
    bacentaId: ID!
    target: Int!
    sprinterTopUp: Float!
    urvanTopUp: Float!
    outbound: Boolean!
  ): Bacenta!
    @authentication(
      jwt: {
        OR: [
          { roles_INCLUDES: "adminCampus" }
          { roles_INCLUDES: "arrivalsAdminCampus" }
          { roles_INCLUDES: "adminStream" }
          { roles_INCLUDES: "arrivalsAdminStream" }
        ]
      }
    )
    @cypher(
      statement: """
      MATCH (bacenta:Bacenta {id: $bacentaId})

      WITH bacenta
      MATCH (bacenta)
        SET bacenta.sprinterTopUp = $sprinterTopUp,
          bacenta.urvanTopUp = $urvanTopUp,
          bacenta.outbound = $outbound

      WITH DISTINCT bacenta
      CREATE (log:HistoryLog {id:apoc.create.uuid()})
        SET log.timeStamp = datetime(),
        log.historyRecord = bacenta.name + ' Bussing Details were updated'

      WITH log,bacenta
      MATCH (admin:Member {auth_id: $jwt.sub})
      MERGE (date:TimeGraph {date: date()})

      MERGE (log)-[:LOGGED_BY]->(admin)
      MERGE (log)-[:RECORDED_ON]->(date)
      MERGE (bacenta)-[:HAS_HISTORY]->(log)

      RETURN bacenta
      """
      columnName: "bacenta"
    )

  UpdateBusPaymentDetails(
    bacentaId: ID!
    mobileNetwork: String!
    momoName: String!
    momoNumber: String!
  ): Bacenta!
    @authentication(jwt: { roles_INCLUDES: "leaderBacenta" })
    @cypher(
      statement: """
      MATCH (bacenta:Bacenta {id: $bacentaId})
        SET bacenta.mobileNetwork = $mobileNetwork,
        bacenta.momoName = $momoName,
        bacenta.momoNumber = $momoNumber
      REMOVE bacenta.recipientCode

      WITH bacenta
      CREATE (log:HistoryLog {id:apoc.create.uuid()})
        SET log.timeStamp = datetime(),
        log.historyRecord = bacenta.name + ' Bus Payment Details were updated'

      WITH log,bacenta
      MATCH (admin:Member {auth_id: $jwt.sub})
      MERGE (date:TimeGraph {date:date()})
      MERGE (log)-[:LOGGED_BY]->(admin)
      MERGE (log)-[:RECORDED_ON]->(date)
      MERGE (bacenta)-[:HAS_HISTORY]->(log)

      RETURN bacenta
      """
      columnName: "bacenta"
    )

  UploadMobilisationPicture(
    bacentaId: ID!
    serviceDate: String!
    mobilisationPicture: String!
  ): BussingRecord!

  #Bussing Records Entries
  RecordVehicleFromBacenta(
    bacentaId: ID!
    bussingRecordId: ID!
    leaderDeclaration: Int!
    vehicle: String!
    picture: String!
  ): VehicleRecord!

  SetVehicleSupport(vehicleRecordId: ID!): VehicleRecord!

  ConfirmVehicleByAdmin(
    vehicleRecordId: ID!
    attendance: Int!
    vehicle: String!
    comments: String
  ): VehicleRecord!
    @authentication(jwt: { roles_INCLUDES: "arrivalsCounterStream" })
    @cypher(
      statement: """
      MATCH (vehicleRecord:VehicleRecord {id: $vehicleRecordId}) WHERE vehicleRecord.arrivalTime IS NULL
        SET vehicleRecord.attendance = $attendance,
        vehicleRecord.vehicle = $vehicle,
        vehicleRecord.comments = $comments

         WITH vehicleRecord
          MATCH (admin:Member {auth_id: $jwt.sub})
          MERGE (vehicleRecord)-[:COUNTED_BY]->(admin)

      RETURN vehicleRecord
      """
      columnName: "vehicleRecord"
    )

  SetSwellDate(date: String!): TimeGraph!
  SendVehicleSupport(
    vehicleRecordId: ID!
    momoName: String!
    momoNumber: String!
    vehicleTopUp: Int!
    outbound: Boolean!
  ): VehicleRecord!
}

extend type Mutation {
  SetStreamArrivalTimes(
    id: ID!
    mobilisationStartTime: String!
    mobilisationEndTime: String!
    arrivalStartTime: String!
    arrivalEndTime: String!
  ): Stream!
    @cypher(
      statement: """
      MATCH (stream:Stream {id: $id})
      SET stream.mobilisationStartTime = $mobilisationStartTime,
        stream.mobilisationEndTime = $mobilisationEndTime,
        stream.arrivalStartTime = $arrivalStartTime,
        stream.arrivalEndTime = $arrivalEndTime
      RETURN stream
      """
      columnName: "stream"
    )
    @authentication(
      jwt: {
        OR: [
          { roles_INCLUDES: "adminStream" }
          { roles_INCLUDES: "arrivalsAdminStream" }
          { roles_INCLUDES: "adminCampus" }
          { roles_INCLUDES: "arrivalsAdminCampus" }
        ]
      }
    )
}

#SETTING AND ENDING TIME THINGS
extend type Stream {
  mobilisationStartTime: DateTime
  mobilisationEndTime: DateTime
  arrivalStartTime: DateTime
  arrivalEndTime: DateTime
}

extend type Mutation {
  SendMobileVerificationNumber(
    firstName: String!
    phoneNumber: String!
    otp: String!
  ): String!

  SetStreamArrivalTimes(
    id: ID!
    mobilisationStartTime: String!
    mobilisationEndTime: String!
    arrivalStartTime: String!
    arrivalEndTime: String!
  ): Stream!
    @cypher(
      statement: """
      MATCH (stream:Stream {id: $id})
      SET stream.mobilisationStartTime = $mobilisationStartTime,
        stream.mobilisationEndTime = $mobilisationEndTime,
        stream.arrivalStartTime = $arrivalStartTime,
        stream.arrivalEndTime = $arrivalEndTime
      RETURN stream
      """
      columnName: "stream"
    )
    @authentication(
      jwt: {
        OR: [
          { roles_INCLUDES: "adminStream" }
          { roles_INCLUDES: "arrivalsAdminStream" }
          { roles_INCLUDES: "adminCampus" }
          { roles_INCLUDES: "arrivalsAdminCampus" }
        ]
      }
    )
}

type ArrivalsSheetData {
  date: Date
  stream: String
  councilHead: String
  bacenta: String
  leader: String
  bacentaCode: String
  attendance: Int
  confirmedAttendance: Int
  vehicle: String
  outbound: String
  topUp: Float
  vehicleCost: Float
  momoNumber: String
  comments: String
  arrivalTime: DateTime
  council: String
  governorship: String
  society: String
  momoName: String
}

extend type Stream {
  arrivalsPaymentData(arrivalsDate: String): [ArrivalsSheetData!]!
}
